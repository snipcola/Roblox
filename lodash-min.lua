local a={}if type(table.pack)~='function'then function table.pack(...)return{n=select("#",...),...}end end;if type(table.unpack)~='function'then table.unpack=unpack end;a.chunk=function(b,c)local d={}local c=c==0 and 1 or c or 1;local e,f=1,1;while true do d[f]={}for g=1,c do a.push(d[f],b[e])e=e+1 end;if a.gt(e,#b)then break end;f=f+1 end;return d end;a.compact=function(b)local d={}for h,i in pairs(b)do if i then a.push(d,i)end end;return d end;a.difference=function(b,...)local d={}local e=1;local j=false;local k=a.table(...)for h,i in ipairs(b)do repeat while not a.isNil(k[e])and not j do for g,l in ipairs(k[e])do if i==l then j=true end end;if not j then e=e+1 end end;if j then j=false;e=1;break end;a.push(d,i)e=1 until true end;return d end;a.drop=function(b,m)local m=m or 1;return a.slice(b,m+1)end;local n=function(o,p,...)local q;local o=o or a.identity;if p then q=o(p,...)else q=o(...)end;return q end;a.dropRight=function(b,m)local m=m or 1;return a.slice(b,nil,#b-m)end;local r=function(b,o,p,s,t,u)local d={}local e=s;while not a.isNil(b[e])do repeat if#d==0 and n(o,p,b[e],e,b)then e=e+t;break end;if u then a.enqueue(d,b[e])else a.push(d,b[e])end;e=e+t until true end;return d end;a.dropRightWhile=function(b,o,p)return r(b,o,p,#b,-1,true)end;a.dropWhile=function(b,o,p)return r(b,o,p,1,1)end;a.enqueue=function(b,v)return table.insert(b,1,v)end;a.fill=function(b,v,s,w)local s=s or 1;local w=w or#b;for f=s,w,s>w and-1 or 1 do b[f]=v end;return b end;local x=function(b,o,p,s,t)local e=s;while not a.isNil(b[e])do if n(o,p,b[e],e,b)then return e end;e=e+t end;return-1 end;a.findIndex=function(b,o,p)return x(b,o,p,1,1)end;a.findLastIndex=function(b,o,p)return x(b,o,p,#b,-1)end;a.first=function(b)return b[1]end;a.flatten=function(b,y)local d={}for h,i in ipairs(b)do if a.isTable(i)then local z;if y then z=a.flatten(i)else z=i end;for A,l in ipairs(z)do a.push(d,l)end else a.push(d,i)end end;return d end;a.flattenDeep=function(b)return a.flatten(b,true)end;a.indexOf=function(b,v,B)return a.findIndex(b,function(m)return m==v end)end;a.initial=function(b)return a.slice(b,nil,#b-1)end;a.intersection=function(...)local k=a.table(...)local C=table.remove(k,1)local d={}for f,i in ipairs(C)do local D=false;for E,l in ipairs(k)do if a.indexOf(l,i)==-1 then D=true;break end end;if not D then a.push(d,i)end end;return d end;a.last=function(b)return b[#b]end;a.lastIndexOf=function(b,v,B)return a.findLastIndex(b,function(m)return m==v end)end;a.pull=function(b,...)local f=1;local j=false;while not a.isNil(b[f])do repeat for h,i in ipairs(a.table(...))do if b[f]==i then table.remove(b,f)j=true end end;if j then j=false;break end;f=f+1 until true end;return b end;a.push=function(b,v)return table.insert(b,v)end;a.pullAt=function(b,...)local d={}local k=a.table(...)table.sort(k,function(F,G)return a.gt(F,G)end)for f,H in ipairs(k)do a.enqueue(d,table.remove(b,H))end;return d end;a.remove=function(b,o)local d={}local e=1;local o=o or a.identity;while not a.isNil(b[e])do repeat if o(b[e],e,b)then a.push(d,table.remove(b,e))break end;e=e+1 until true end;return d end;a.rest=function(b)return a.slice(b,2,#b)end;a.reverse=function(b)local d={}for f,i in ipairs(b)do a.enqueue(d,i)end;return d end;a.slice=function(b,s,w)local s=s or 1;local w=w or#b;local d={}for f=s,w do d[f-s+1]=b[f]end;return d end;a.take=function(b,m)local m=m or 1;return a.slice(b,1,m)end;a.takeRight=function(b,m)local m=m or 1;return a.slice(b,#b-m+1)end;local I=function(b,o,p,s,t,u)local d={}local e=s;while not a.isNil(b[e])do if n(o,p,b[e],e,b)then if u then a.enqueue(d,b[e])else a.push(d,b[e])end else break end;e=e+t end;return d end;a.takeRightWhile=function(b,o,p)return I(b,o,p,#b,-1,true)end;a.union=function(...)local k=a.table(...)local d={}for f,b in ipairs(k)do for E,i in ipairs(b)do if a.indexOf(d,i)==-1 then a.push(d,i)end end end;return d end;a.takeWhile=function(b,o,p)return I(b,o,p,1,1)end;a.uniq=function(b,J,p)local d={}local K={}for h,i in ipairs(b)do local L=n(J,p,i,h,b)if a.indexOf(K,L)==-1 then a.push(d,i)end;a.push(K,L)end;return d end;a.zipObject=function(...)local k=a.table(...)local d={}if#k==1 then for f,M in ipairs(k[1])do d[M[1]]=M[2]end else for f=1,#k[1]do d[k[1][f]]=k[2][f]end end;return d end;a.unzip=function(b)return a.zip(a.args(b))end;a.without=function(b,...)local d={}for f,i in ipairs(b)do local N=a.table(...)if a.indexOf(N,i)==-1 then a.push(d,i)end end;return d end;a.zip=function(...)local d={}for f,b in ipairs(a.table(...))do for g,i in ipairs(b)do d[g]=d[g]or{}d[g][f]=i end end;return d end;a.at=function(O,...)local d={}for h,P in ipairs(a.table(...))do if a.isTable(P)then for h,P in ipairs(P)do a.push(d,O[P])end else a.push(d,O[P])end end;return d end;a.countBy=function(O,J,p)local d={}for h,i in a.iter(O)do local L=a.str(n(J,p,i,h,O))if a.isNil(d[L])then d[L]=1 else d[L]=d[L]+1 end end;return d end;a.groupBy=function(O,J,p)local d={}for h,i in a.iter(O)do local L=a.str(n(J,p,i,h,O))if a.isNil(d[L])then d[L]={i}else a.push(d[L],i)end end;return d end;a.indexBy=function(O,J,p)local d={}for h,i in a.iter(O)do local L=a.str(n(J,p,i,h,O))d[L]=i end;return d end;a.every=function(O,o,p)for h,i in a.iter(O)do if not n(o,p,i,h,O)then return false end end;return true end;local Q=function(O,o,p,R)local d={}for h,i in a.iter(O)do local S=n(o,p,i,h,O)if R then if not S then a.push(d,i)end else if S then a.push(d,i)end end end;return d end;a.filter=function(O,o,p)return Q(O,o,p)end;a.forEach=function(O,o,p)for h,i in a.iter(O)do n(o,p,i,h,O)end;return O end;a.forEachRight=function(O,o,p)for h,i in a.iterRight(O)do n(o,p,i,h,O)end;return O end;a.includes=function(O,T)local q=a.find(O,function(m)return m==T end)return q~=nil end;a.invoke=function(O,U,...)local d={}for h,i in a.iter(O)do a.push(d,n(U,i,...))end;return d end;a.map=function(O,J,p)local d={}for h,i in a.iter(O)do d[h]=n(J,p,i,h,O)end;return d end;a.partition=function(O,o,p)local d={{},{}}for h,i in a.iter(O)do if n(o,p,i,h,O)then a.push(d[1],i)else a.push(d[2],i)end end;return d end;a.pluck=function(O,V)local d={}for h,v in a.iter(O)do a.push(d,a.get(v,V))end;return d end;a.reduce=function(O,J,W,p)local W=W;for h,i in a.iter(O)do if a.isNil(W)then W=i else W=n(J,p,W,i,h,O)end end;return W end;a.reduceRight=function(O,J,W,p)local W=W;for h,i in a.iterRight(O)do if a.isNil(W)then W=i else W=n(J,p,W,i,h,O)end end;return W end;a.reject=function(O,o,p)return Q(O,o,p,true)end;a.sample=function(O,m)local m=m or 1;local d={}local X=a.keys(O)for f=1,m do local Y=X[a.random(1,#X)]a.push(d,a.get(O,{Y}))end;return#d==1 and d[1]or d end;a.size=function(O)local e=0;for h,i in a.iter(O)do e=e+1 end;return e end;a.some=function(O,o,p)for h,i in a.iter(O)do if n(o,p,i,h,O)then return true end end;return false end;a.sortBy=function(O,o,p)local d={}local Z=true;local _;for h,i in a.iter(O)do if Z then a.push(d,i)_=n(o,p,i,h,O)Z=false else local L=n(o,p,i,h,O)if a.lt(_,L)then table.insert(d,i)_=L else table.insert(d,#d,i)end end end;return d end;a.find=function(O,o,p)for h,i in a.iter(O)do if n(o,p,i,h,O)then return i end end end;a.findLast=function(O,o,p)for h,i in a.iterRight(O)do if n(o,p,i,h,O)then return i end end end;a.after=function(m,a0)local f=1;return function(...)if a.gt(f,m)then return a0(...)end;f=f+1 end end;a.ary=function(a0,m)return function(...)if m==1 then return a0(...)else local d=a.table(...)local C=a.take(d,m)return a0(a.args(C))end end end;a.before=function(m,a0)local f=1;local q;return function(...)if a.lte(f,m)then q=a0(...)end;f=f+1;return q end end;a.modArgs=function(a0,...)local a1={}for f,i in ipairs(a.table(...))do if a.isFunction(i)then a.push(a1,i)elseif a.isTable(i)then for A,l in a.iter(i)do if a.isFunction(l)then a.push(a1,l)end end end end;return function(...)local N;for f,a2 in ipairs(a1)do if a.isNil(N)then N=a.table(a2(...))else N=a.table(a2(a.args(N)))end end;if a.isNil(N)then return a0(...)else return a0(a.args(N))end end end;a.negate=function(a0)return function(...)return not a0(...)end end;a.once=function(a0)local a3=false;local q;return function(...)if not a3 then q=a0(...)a3=true end;return q end end;a.rearg=function(a0,...)local a4={}for f,i in ipairs(a.table(...))do if a.isNumber(i)then a.push(a4,i)elseif a.isTable(i)then for A,l in a.iter(i)do if a.isNumber(l)then a.push(a4,l)end end end end;return function(...)local N=a.table(...)local a5={}for f,H in ipairs(a4)do a.push(a5,N[H])end;if#a4==0 then return a0(...)else return a0(a.args(a5))end end end;a.args=function(v)if a.isTable(v)then return table.unpack(v)else return table.unpack({v})end end;a.gt=function(v,a6,...)local v,a6=a.cast(v,a6)if a.isString(v)or a.isNumber(v)then return v>a6 elseif a.isFunction(v)then return v(...)>a6(...)end;return false end;a.gte=function(v,a6,...)if a.isNil(v)or a.isBoolean(v)then return v==a6 end;local v,a6=a.cast(v,a6)if a.isString(v)or a.isNumber(v)then return v>=a6 elseif a.isFunction(v)then return v(...)>=a6(...)elseif a.isTable(v)then return false end;return false end;a.isBoolean=function(v)return type(v)=='boolean'end;a.isEmpty=function(v)if a.isString(v)then return#v==0 elseif a.isTable(v)then local f=0;for h,i in a.iter(v)do f=f+1 end;return f==0 else return true end end;a.isFunction=function(v)return type(v)=='function'end;a.isNil=function(v)return type(v)=='nil'end;a.isNumber=function(v)return type(v)=='number'end;a.isString=function(v)return type(v)=='string'end;a.isTable=function(v)return type(v)=='table'end;a.lt=function(v,a6,...)local v,a6=a.cast(v,a6)if a.isString(v)or a.isNumber(v)then return v<a6 elseif a.isFunction(v)then return v(...)<a6(...)end;return false end;a.lte=function(v,a6,...)if a.isNil(v)or a.isBoolean(v)then return v==a6 end;local v,a6=a.cast(v,a6)if a.isString(v)or a.isNumber(v)then return v<=a6 elseif a.isFunction(v)then return v(...)<=a6(...)elseif a.isTable(v)then return false end;return false end;a.cast=function(F,G)if type(F)==type(G)then return F,G end;local a7;if a.isString(F)then a7=a.str elseif a.isBoolean(F)then a7=a.bool elseif a.isNumber(F)then a7=a.num elseif a.isFunction(F)then a7=a.func elseif a.isTable(F)then a7=a.table end;return F,a7(G)end;a.func=function(...)local d=a.table(...)return function()return a.args(d)end end;a.table=function(...)return table.pack(...)end;a.bool=function(v,...)local a8=false;if a.isString(v)then a8=#v>0 elseif a.isBoolean(v)then a8=v elseif a.isNumber(v)then a8=v~=0 elseif a.isFunction(v)then a8=a.bool(v(...))end;return a8 end;a.num=function(v,...)local a9=0;if a.isString(v)then ok=pcall(function()a9=v+0 end)if not ok then a9=math.huge end elseif a.isBoolean(v)then a9=v and 1 or 0 elseif a.isNumber(v)then a9=v elseif a.isFunction(v)then a9=a.num(v(...))end;return a9 end;local aa=function(i)return'"'..i..'"'end;a.str=function(v,...)local ab=''if a.isString(v)then ab=v elseif a.isBoolean(v)then ab=v and'true'or'false'elseif a.isNil(v)then ab='nil'elseif a.isNumber(v)then ab=v..''elseif a.isFunction(v)then ab=a.str(v(...))elseif a.isTable(v)then ab='{'for h,i in pairs(v)do i=a.isString(i)and aa(i)or a.str(i,...)if a.isNumber(h)then ab=ab..i..', 'else ab=ab..'['..aa(h)..']='..i..', 'end end;ab=ab:sub(0,#ab-2)..'}'end;return ab end;a.inRange=function(m,s,w)local ac=a.isNil(w)and 0 or s or 0;local ad=a.isNil(w)and s or w or 1;return m>=ac and m<ad end;a.random=function(ae,af,ag)local ah=a.isNil(af)and 0 or ae or 0;local ai=a.isNil(af)and ae or af or 1;math.randomseed(os.clock()*math.random(os.time()))local L=math.random(ah,ai)if ag then L=L+math.random()end;return L end;a.assign=function(aj,...)for H=1,select('#',...)do for h,i in pairs(select(H,...))do aj[h]=i end end;return aj end;a.get=function(aj,V,ak)if a.isTable(aj)then local v=aj;local e=1;while not a.isNil(V[e])do if not a.isTable(v)then return ak end;v=v[V[e]]e=e+1 end;return v or ak elseif a.isString(aj)then local H=V[1]return aj:sub(H,H)end end;a.has=function(aj,V)local al=aj;local e=1;local am=true;while not a.isNil(V[e])do al=al[V[e]]if a.isNil(al)then am=false;break end;e=e+1 end;return am end;a.findKey=function(aj,o,p)for h,i in a.iter(aj)do if n(o,p,i,h,aj)then return h end end end;a.findLastKey=function(aj,o,p)for h,i in a.iterRight(aj)do if n(o,p,i,h,aj)then return h end end end;a.functions=function(aj)local d={}for h,i in a.iter(aj)do if a.isFunction(i)then a.push(d,h)end end;return d end;a.invert=function(aj,an)local d={}for h,i in a.iter(aj)do if an and not a.isNil(d[i])then d[i]={d[i]}a.push(d[i],h)else d[i]=h end end;return d end;local ao=function(O,ap)local aq={}for h,i in pairs(O)do table.insert(aq,h)end;if ap then table.sort(aq,a.gt)else table.sort(aq,a.lt)end;return aq end;a.keys=function(aj)if a.isTable(aj)then return ao(aj)elseif a.isString(aj)then local X={}for f=1,#aj do X[f]=f end;return X end end;a.pairs=function(aj)local d={}for h,i in a.iter(aj)do a.push(d,{h,i})end;return d end;a.result=function(aj,V,ak,...)local q=a.get(aj,V,ak)if a.isFunction(q)then return q(...)else return q end end;a.values=function(aj)local d={}for h,i in a.iter(aj)do a.push(d,i)end;return d end;a.constant=function(v)return a.func(v)end;a.identity=function(...)return...end;local ar=function(table,ap)local aq=ao(table,ap)local f=0;return function()if a.lt(f,#aq)then f=f+1;local P=aq[f]return P,table[P]end end end;a.iter=function(v)if a.isString(v)then local f=0;return function()if a.lt(f,#v)then f=f+1;local e=v:sub(f,f)return f,e end end elseif a.isTable(v)then return ar(v)else return function()end end end;a.iterRight=function(v)if a.isString(v)then local f=#v+1;return function()if a.gt(f,1)then f=f-1;local e=v:sub(f,f)return f,e end end elseif a.isTable(v)then return ar(v,true)else return function()end end end;a.noop=function(...)return nil end;a.print=function(...)local d=a.table(...)for f,i in ipairs(d)do d[f]=a.str(d[f])end;return print(a.args(d))end;a.range=function(s,...)local s=s;local N=a.table(...)local F,G,e;if#N==0 then F=1;G=s;e=1 else F=s;G=N[1]e=N[2]or 1 end;local d={}for f=F,G,e do a.push(d,f)end;return d end;return a
